{% extends 'layout.html' %}{%block initgame%}
<br> {% load static %}
<div class="row">
    <div class="col s7 push-s5 center">
        <span class="flow-text">
            <div class="row inicial filaNegra1 filaRoja8" ondragover="drop(event)">
              <img class="img_base filaNegra1 filaRoja8">

              <img class="img_peon" id="N1" draggable='true'  ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">
              <img class="img_peon" id="N1" draggable='true'  ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">
              <img class="img_peon" id="N1" draggable='true'  ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">
              <img class="img_peon" id="N1" draggable='true'  ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">
              <img class="img_peon" id="N1" draggable='true'  ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">
              <img class="img_peon" id="N1" draggable='true'  ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">

            </div>

            <img class="img_peon" src="{% static 'img/barra.png' %}" width="370px" height="10px" alt="">

            <div class="row filaNegra2 filaRoja7" ondragover="drop(event)" >
              <img class="img_base filaNegra2 filaRoja7">
              <img class="img_peon" id="N2" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">

              <img class="img_peon" id="R7" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">

            </div>
            <img class="img_peon" src="{% static 'img/barra.png' %}" width="370px" height="10px" alt="">

            <div class="row filaNegra3 filaRoja6" ondragover="drop(event)">
              <img class="img_base filaNegra3 filaRoja6">

              <img class="img_peon" id="N3" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">

              <img class="img_peon" id="R6" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">

            </div>

            <img class="img_peon" src="{% static 'img/barra.png' %}" width="370px" height="10px" alt="">

            <div class="row filaNegra4 filaRoja5" ondragover="drop(event)">
              <img class="img_base filaNegra4 filaRoja5">

              <img class="img_peon" id="N4" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">

              <img class="img_peon" id="R5" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">
            </div>

            <img class="img_peon" src="{% static 'img/barra.png' %}" width="370px" height="10px" alt="">

            <div class="row filaNegra5 filaRoja4" ondragover="drop(event)">
              <img class="img_base filaNegra5 filaRoja4">

              <img class="img_peon" id="N5" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">

              <img class="img_peon" id="R4" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">

            </div>

            <img class="img_peon" src="{% static 'img/barra.png' %}" width="370px" height="10px" alt="">

            <div class="row filaNegra6 filaRoja3" ondragover="drop(event)">
              <img class="img_base filaNegra6 filaRoja3">

              <img class="img_peon" id="N6" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">

              <img class="img_peon" id="R3" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">

            </div>

            <img class="img_peon" src="{% static 'img/barra.png' %}" width="370px" height="10px" alt="">

            <div class="row filaNegra7 filaRoja2" ondragover="drop(event)">
              <img class="img_base filaNegra7 filaRoja2">

              <img class="img_peon" id="N7" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-negro.png' %}" width="40px" alt="Negro">

              <img class="img_peon" id="R2" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">

            </div>

            <img class="img_peon" src="{% static 'img/barra.png' %}" width="370px" height="10px" alt="">

            <div class="row inicial filaNegra8 filaRoja1" ondragover="drop(event)">
              <img class="img_base filaNegra8 filaRoja1">

              <img class="img_peon" id="R1" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">
              <img class="img_peon" id="R1" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">
              <img class="img_peon" id="R1" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">
              <img class="img_peon" id="R1" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">
              <img class="img_peon" id="R1" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">
              <img class="img_peon" id="R1" draggable='true' ondragstart="dragIniciado(event)" ondragend="dragFinalizado(event)"  src="{% static 'img/peon-rojo.png' %}" width="45px" alt="Rojo">

            </div>
        </span>
    </div>
    <div class="col s5 pull-s7">
        <span class="flow-text">
            <ul class="collection">
                <li class="collection-item avatar">
                    <i class="material-icons circle">mood</i>
                    <span class="title">Jugador Uno</span>
        <p>Movimiento: 1</p>
        <span class="title">Puntos: 8</span>

        <a href="#!" class="secondary-content"><i class="material-icons">grade</i></a>
        </li>
        <li class="collection-item avatar">
            <i class="material-icons circle">videogame_asset</i>
            <span class="title">Jugador Dos</span>
            <p>Movimiento: 1</p>
            <span class="title">Puntos: 2</span>
            <a href="#!" class="secondary-content"><i class="material-icons">grade</i></a>
        </li>
        </ul>
        </span>
    </div>
</div>

<script>
    console.log('Hola erika....')
    var dragged;

    function dragIniciado(event) {
        dragged = event.target;
        event.target.style.opacity = .5;
        console.log('dragIniciado')
        //console.log(event.target.id);
    }

    function dragFinalizado(event) {
        event.target.style.opacity = "";
        console.log('dragFinalizado')
    }

    function dragEnter(event) {
        console.log('dragEnter', event.target.className)
        if (event.target.className == "row") {
            event.target.style.background = "yellow";
        }
    }

    function dragLeave(event) {
        console.log('dragLeave', event.target.className)
        if (event.target.className == "row") {
            event.target.style.background = "";
        }
    }
    var jugador1=0;

    function drop(event) {
        console.log('drop')
        //event.preventDefault();
        // move dragged elem to the selected drop target
        //console.log('drop', dragged)
        if (event.target.className == "row inicial filaNegra8 filaRoja1" || event.target.className == "row inicial filaNegra1 filaRoja8") {
          //
          //event.target.style.background = "";
          //dragged.parentNode.removeChild(dragged);
          devolverFichas(30);

          //event.target.appendChild(dragged);

        }else if (event.target.className.includes("row")) {
          var x = event.target.innerHTML;
          var a = event.target;
          var cont=0;
          var fila=0;
          var posFila=0;
          devolverFichas(6);

          }else{
            console.log('No puede tener mas de 6 peones');
          }


      }

      function devolverFichas(limite){
        var x = event.target.innerHTML;
        var a = event.target;
        var cont=0;
        var fila=0;
        var posFila=0;
        if(dragged.alt == "Negro"){

          for (var i = 0; i < x.length; i++) {

            if(x.substring(i,i+8)=="img_peon"){
              cont++;
            }
          }

          for (var i = 0; i < x.length; i++) {
            if(x.substring(i,i+9)=="filaNegra"){
              posFila=i;
            }
          }

          fila = x.substring(posFila+9,posFila+10);
          idPeon= dragged.id;
          if(cont < limite && fila>= idPeon[1]){
            event.target.style.background = "";
            dragged.parentNode.removeChild(dragged);
            jugador1++;
            dragged.id = "N"+fila;
            event.target.appendChild(dragged);

        }
      }
        if(dragged.alt == "Rojo"){
          console.log('Rojo');
          for (var i = 0; i < x.length; i++) {

            if(x.substring(i,i+8)=="img_peon"){
              cont++;
            }
          }

          for (var i = 0; i < x.length; i++) {
            if(x.substring(i,i+8)=="filaRoja"){
              posFila=i;
            }
          }

          fila = x.substring(posFila+8,posFila+9);
          idPeon= dragged.id;
          //console.log(idPeon[1]);
          if(cont < limite && fila>= idPeon[1]){
            event.target.style.background = "";
            dragged.parentNode.removeChild(dragged);
            jugador1++;
            dragged.id = "R"+fila;

            event.target.appendChild(dragged);

        }
      }
      }


</script>
<br>{%endblock%}
